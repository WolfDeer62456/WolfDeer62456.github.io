<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="$#C240808C. 简单数论题, WolfDeer"><meta name="description" content="gcd"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>$#C240808C. 简单数论题 | WolfDeer</title><link rel="icon" type="image/png" href="https://wolfdeer62456.github.io/favicon.png"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/awesome/css/all.min.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/css/matery.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/css/my.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="https://wolfdeer62456.github.io/libs/tocbot/tocbot.css"><link rel="stylesheet" href="https://wolfdeer62456.github.io/css/post.css"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/css/reward.css"><script src="https://wolfdeer62456.github.io/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="https://wolfdeer62456.github.io/atom.xml" title="WolfDeer" type="application/atom+xml"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="https://wolfdeer62456.github.io/" class="waves-effect waves-light"><img src="https://wolfdeer62456.github.io/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">WolfDeer</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://wolfdeer62456.github.io/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://wolfdeer62456.github.io/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">WolfDeer</div><div class="logo-desc">Learning Blog</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="https://wolfdeer62456.github.io/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/WolfDeer62456/WolfDeer62456.github.io" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/WolfDeer62456/WolfDeer62456.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><script src="https://wolfdeer62456.github.io/libs/cryptojs/crypto-js.min.js"></script><script>(()=>{var e="f8a84ce0b17444ee9e281e5f7cf7211eae80c54c97e44e06649d2a533df3ca38";0<e.length&&e!==CryptoJS.SHA256(prompt("唯有心有灵犀，方能始终如一")).toString(CryptoJS.enc.Hex)&&(alert("我们难以心灵相拥。"),location.href="https://wolfdeer62456.github.io/")})()</script><div class="bg-cover pd-header post-cover" style="background-image:url(https://wolfdeer62456.github.io/medias/featureimages/88.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">$#C240808C. 简单数论题</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="https://wolfdeer62456.github.io/tags/gcd/"><span class="chip bg-color">gcd</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="https://wolfdeer62456.github.io/categories/%E9%A2%98%E7%9B%AE/" class="post-category">题目</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2024-08-08</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp; 2024-11-11</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 4.9k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp; 25 分</div></div></div><hr class="clearfix"><link rel="stylesheet" href="https://wolfdeer62456.github.io/libs/prism/prism.min.css"><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre-wrap!important}</style><div class="card-content article-card-content"><div id="articleContent"><h1 id="C240808C-简单数论题"><a href="#C240808C-简单数论题" class="headerlink" title="$#C240808C. 简单数论题"></a>$#C240808C. 简单数论题</h1><h2 id="网址（Website）"><a href="#网址（Website）" class="headerlink" title="网址（Website）"></a>网址（Website）</h2><p><a target="_blank" rel="noopener" href="http://192.168.110.4/p/C240808C">题目详情 - 简单数论题 - Super</a></p><p><a target="_blank" rel="noopener" href="http://192.168.110.4/p/C240808C/solution">题解 - 简单数论题 - Super</a></p><h2 id="题目（Problem）"><a href="#题目（Problem）" class="headerlink" title="题目（Problem）"></a>题目（Problem）</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>给定一个长度为 $ n $ 的正整数数列 $ a_1, a_2, \ldots, a_n $。</p><p>定义一个不交区间集为若干个不相交的区间组成的集合 $ [l_1, r_1], [l_2, r_2], \ldots, [l_k, r_k] $，其中 $ 1 \leq l_1 \leq r_1 &lt; l_2 \leq r_2 &lt; \ldots &lt; l_k \leq r_k \leq n $。</p><p>给定一个不交区间集，首先对每一个区间计算出里面所有数字的 $ \gcd $，记作 $ \gcd_{i \in [l_j, r_j]} a_i $。我们称一个不交区间集是好的，当且仅当：</p><p>$ \gcd_{i \in [l_1, r_1]} a_i &#x3D; \gcd_{i \in [l_2, r_2]} a_i &#x3D; \ldots &#x3D; \gcd_{i \in [l_k, r_k]} a_i $</p><p>两个不交区间集不同当且仅当里面包含的区间不同。请对于每个 $ a_i $，求出包含它的不同的好的不交区间集的个数。</p><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><ul><li>从文件 <code>gcd.in</code> 读入数据。</li><li>输入的第一行包含一个正整数 $ n $，表示数列的长度。</li><li>接下来一行包含 $ n $ 个正整数，代表数列里面的每个数。</li></ul><h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><ul><li>输出到文件 <code>gcd.out</code>。</li><li>输出 $ n $ 行，每行一个正整数，代表包含每个数字的不同的好的不交区间集的个数。</li><li>答案对 $ 998244353 $ 取模。</li></ul><h3 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h3><h4 id="输入数据-1"><a href="#输入数据-1" class="headerlink" title="输入数据 1"></a>输入数据 1</h4><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">3
2 3 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="输出数据-1"><a href="#输出数据-1" class="headerlink" title="输出数据 1"></a>输出数据 1</h4><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">4
4
4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="样例1解释"><a href="#样例1解释" class="headerlink" title="样例1解释"></a>样例1解释</h4><p>所有好的不交区间集为：</p><ul><li>{[1,1]}</li><li>{[2,2]}</li><li>{[3,3]}</li><li>{[1,2]}</li><li>{[1,3]}</li><li>{[2,3]}</li><li>{[1,1], [3,3]}</li></ul><h3 id="数据规模与约定"><a href="#数据规模与约定" class="headerlink" title="数据规模与约定"></a>数据规模与约定</h3><p>对于所有数据，有：</p><ul><li>$ 1 \leq n \leq 10^5 $</li><li>$ 1 \leq a_i \leq 10^9 $</li></ul><h3 id="测试点"><a href="#测试点" class="headerlink" title="测试点"></a>测试点</h3><table><thead><tr><th align="left">测试点</th><th align="left">$ n \leq $</th><th align="left">特殊性质</th></tr></thead><tbody><tr><td align="left">$1\sim6$</td><td align="left">$10$</td><td align="left">无</td></tr><tr><td align="left">$7\sim12$</td><td align="left">$10^5$</td><td align="left">所有数字均为 2 的整数次幂</td></tr><tr><td align="left">$13\sim20$</td><td align="left">$10^5$</td><td align="left">无</td></tr></tbody></table><h2 id="题解（Solution）"><a href="#题解（Solution）" class="headerlink" title="题解（Solution）"></a>题解（Solution）</h2><p>你这家伙怎么自己都不会打部分分啊？(恼)（2024.08.08）</p><p>花费了大概一天的时间把这道题打了一遍但是还是有很多地方没有理解清楚。（2024.08.09）</p><p>如此看来，写题解还是很重要的，可以增进理解。（2024.08.12）</p><p>哇！题解写的什么抽象代码啊！每个线段树计算答案不统一写，害得我理解了几个小时。后面自己推了一遍，最后还是按自己的做法做出来了！（2024.08.14）</p><h3 id="我的题解"><a href="#我的题解" class="headerlink" title="我的题解"></a>我的题解</h3><p>通过 $RMQ$ 计算一段区间的 $gcd$ ，固定左端点 $i$ ，枚举 $2$ 的进制数 $j$ ，则有 <code>fr[i][j] = __gcd(fr[i][j-1],fr[i+(1&lt;&lt;(j-1))][j-1])</code>；固定右端点，同样有 <code>fl[i][j] = gcd(fl[i][j-1],fl[i-(1&lt;&lt;(j-1))][j-1]);</code> 。枚举端点 $O(n)$ ，枚举进制数 $O(logn)$ ，求 $gcd$ 复杂度 $O(loga)$ ，总复杂度 $O(nlognloga)$ 。</p><p><strong>注</strong>：这里的 <code>fl</code> 和 <code>fr</code> 指的是<strong>固定右端点向左</strong>和<strong>固定左端点向右</strong>的意思。</p><p><strong>性质1</strong>：集合里面加入数字后 $gcd$ 若改变则至少除 $2$ ，所以不同的 $gcd$ 数量最多 $O(nlog⁡a)$ 级别。</p><p><strong>性质2</strong>：对于每一个点 $l$ ，以之为区间的左边界，在端点从 $r$ 转移到 $r+1$ 时，$gcd$ 要么不变，要么变化，因此，对于 $j\in [l,n]$ ，区间 $[l,j]$ 的 $gcd$ 会随着 $j$ 的增长<strong>呈阶梯式下降</strong>趋势。</p><p>令<strong>三元组</strong> $gl[g]&#x3D;\{id,l,r\}$ 表示固定当前区间的<strong>左</strong>端点 $id$ ，满足 $\forall j\in[l,r],GCD_{i&#x3D;id}^{i\le j}a[i]&#x3D;g$ ；同理，令<strong>三元组</strong> $gr[g]&#x3D;\{id,l,r\}$ 表示固定当前区间的<strong>右</strong>端点 $id$ ，满足 $\forall j\in[l,r],(GCD_{i&#x3D;id}^{i\ge j}a[i])&#x3D;g$ 。（解释：$gl$ 可以理解为左边界为 $id$ ，右边界 $j$ 满足 $j\in[l,r]$ 的所有区间 $[i,j]$ 的区间 $gcd$ 为 $g$ ，$gr$ 同理）</p><p><strong>性质3</strong>：对于一个 $g$ ，当前点 $a_i$ 对其的贡献为包含这个点的区间的个数，同时也等于总的 $gcd&#x3D;g$ 的区间的个数减去不包含这个点的区间的个数。</p><p>考虑维护不包含当前点的区间的个数，令 $f[i]$ 表示从 $1$ 到 $i$ 范围内满足 $gcd&#x3D;g$ 的区间组成的方案数，$g[i]$ 表示从 $i$ 到 $n$ 范围内满足 $gcd&#x3D;g$ 的区间组成的方案数，那么对于一个点 $x$ ，包含它的区间的方案数为 $f[n]-f[x-1]\times g[x+1]$ （$f[n]$ 刚好就是总方案数）。</p><p>考虑对于每个 $gcd$ 求出 $f[i]$ 和 $g[i]$ 。对于 $f[i]$ ，将 $gcd&#x3D;g$ 区间（用 $gl[g]$ 存储）的右端点 $id$ 从小到大排序，对于每一个三元组 $(i,l,r)$ ，分类讨论（这里以 $f[i]$ 举例，$g[i]$ 同理）：</p><ul><li>对于右端点小于 $l-1$ 的区间，它们可以和所有 $j\in[l,r]$ 的区间 $[j,i]$ 组合，贡献为 $\sum_{j&#x3D;0}^{l-1} (f[j]\times (r-l+1))$ ，其中 $r-l+1$ 可以提出来，只需要维护 $f[j]$ 的区间和即可。</li><li>对于右端点在 $[l,r]$ 之间的区间，它们只能和自己右端点右边的区间组合，贡献为 $\sum_{j&#x3D;l}^{r}(f[j]\times (r-j))$ ；</li><li>对于右端点大于 $r$ 的点，当前区间必定相交，没有贡献。</li></ul><p>综上，对于 $f[i]$ 和 $g[i]$ ，有：<br>$$<br>f[i]&#x3D;\sum_{j&#x3D;0}^{l-1} (f[j]\times (r-l+1))+\sum_{j&#x3D;l}^{r}(f[j]\times (r-j))\\<br>g[i]&#x3D;\sum_{j&#x3D;r+1}^{n+1}(g[j]\times(r-l+1))+\sum_{j&#x3D;l}^r(g[j]\times(j-l))<br>$$</p><p>$$<br>f[i]&#x3D;(\sum_{j&#x3D;0}^{l-1} f[j])\times(r-l+1) + (\sum_{j&#x3D;l}^rf[j])\times r-\sum_{j&#x3D;l}^{r}f[j]\times j\\<br>g[i]&#x3D;(\sum_{j&#x3D;r+1}^{n+1} g[j])\times(r-l+1) - (\sum_{j&#x3D;l}^rg[j])\times l+\sum_{j&#x3D;l}^rg[j]\times j<br>$$</p><p>分别用线段树维护 $f[i]$、$f[i]\times i$、$g[i]$、$g[i]\times i$ 即可，对于点 $i$ 的答案的贡献就是总方案数 - $(\sum_{j&#x3D;0}^{i-1}f[j])\times (\sum_{j&#x3D;i+1}^{n+1}g[j])$ 。</p><p>发现对于每一个 $gcd$ 都要更新一遍 $1\sim n$ 的答案，不满足时间复杂度。考虑优化。</p><p><strong>性质4</strong>：对于排序后的三元组 $(i,l_i,r_i)$ 和 $(j,l_j,r_j)$ ，当前 $gcd$ 对 $i$ 和 $j$ 中间的数（即 $k\in[i+1,j-1]$ ）的贡献是相同的。</p><p>对于每个 $gcd$ 我们都要枚举对应的三元组，两个三元组之间的数直接用前缀和记录贡献，最后计算即可。</p><p><strong>问题1</strong>：为什么 $(\sum_{j&#x3D;0}^{i-1}f[j])\times (\sum_{j&#x3D;i+1}^{n+1}g[j])$ 是从 $0$ 和 $n+1$ 开始？算上 $f[0]&#x3D;1$ 我可以理解，相当于 $i$ 右边的区间自由组合的方案数， $g[n+1]&#x3D;1$ 算上我也可以理解，但是乘的时候算上了 $f[0]\times g[n+1]$ ，这是什么意思？左边右边都不选？那怎么保证 $gcd&#x3D; g$ 呢？</p><p><strong>解答</strong>：（2024.08.16）后面才发现，计算 $sum&#x3D;\sum_{j&#x3D;0}^{n+1}f[j]$ 的时候也计算了 $f[0]\times g[n+1]$ ，二者相减刚好就抵消掉了。</p><p><strong>问题2</strong>：为什么最后代码打出来发现 $\sum_{j&#x3D;0}^{n+1}f[j]$ 不等于 $\sum_{j&#x3D;0}^{n+1}g[j]$ 呢？最大的问题是：令 $sum$ 等于 $\sum_{j&#x3D;0}^{n+1}f[j]$ 或 $\sum_{j&#x3D;0}^{n+1}g[j]$ 最后计算出来的答案是一样的，但是这两个值可能不同（详见<a href="https://wolfdeer62456.github.io/2024/08/08/C240808C-%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA%E9%A2%98/#%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81">我的代码</a>第 $132$ 行）。</p><p><img src="https://wolfdeer62456.github.io/2024/08/08/C240808C-%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA%E9%A2%98/1.png"></p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>集合里面加入数字后 $gcd$ 若改变则至少除 $2$ ，所以不同的 $gcd$ 数量最多 $O(nloga)$ 级别。</p><p>固定左端点，通过倍增预处理区间 $gcd$ 可以在 $O(nlognloga)$ 的时间复杂度内找出每一个 $gcd$ 发生变化的右端点，记录每一个这样的极大区间。</p><p>枚举 $gcd$，考虑以 $fi$ 代表 $1\sim i$ 中 $gcd$ 等于枚举的数的不交区间集的方案数，这是个简单的 $DP$，可以将区间按左端点排序后利用线段树优化。复杂度与区间个数有关，总复杂度均摊下来也是 $O(nlognloga)$。</p><p>对后缀按相同方式做一遍，则包含 $i$ 位置的方案数就是总数减去只在 $[1,i−1],[i+1,n]$ 中选区间的方案数，后者可以直接通过前后缀计算得到的方案数乘算获得。</p><h2 id="代码（Code）"><a href="#代码（Code）" class="headerlink" title="代码（Code）"></a>代码（Code）</h2><h3 id="题解代码"><a href="#题解代码" class="headerlink" title="题解代码"></a>题解代码</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;bits&#x2F;stdc++.h&gt;
using namespace std;
typedef long long ll;

struct Info&#123;
    int id, p, _p;
    Info(int id &#x3D; 0, int p &#x3D; 0, int _p &#x3D; 0): id(id), p(p), _p(_p)&#123;&#125;
&#125;;

const int MAXN &#x3D; 100000+5;
const ll mod &#x3D; 998244353;
int n, cnt;
int a[MAXN];
int lx[MAXN][18], rx[MAXN][18];
ll lsum[MAXN&lt;&lt;2], lsum2[MAXN&lt;&lt;2], rsum[MAXN&lt;&lt;2], rsum2[MAXN&lt;&lt;2];
ll ans[MAXN], b[MAXN];
vector&lt;Info&gt; lv[MAXN*10], rv[MAXN*10];
map&lt;int, int&gt; mp;

int gcd(int a, int b)&#123;
    return b ? gcd(b, a%b) : a;
&#125;

int find(int g)&#123;
    if(mp.find(g) &#x3D;&#x3D; mp.end()) mp[g] &#x3D; ++cnt;
    return mp[g];
&#125;

void push_up(int x)&#123;
    int ls &#x3D; x&lt;&lt;1, rs &#x3D; x&lt;&lt;1|1;
    lsum[x] &#x3D; lsum[ls] + lsum[rs];
    rsum[x] &#x3D; rsum[ls] + rsum[rs];
    lsum2[x] &#x3D; lsum2[ls] + lsum2[rs];
    rsum2[x] &#x3D; rsum2[ls] + rsum2[rs];
&#125;

void build(int x, int l, int r)&#123;
    if(l &#x3D;&#x3D; r)&#123;
        if(l &#x3D;&#x3D; 0)&#123;
            lsum[x] &#x3D; 1;
        &#125;
        if(r &#x3D;&#x3D; n+1)&#123;
            rsum[x] &#x3D; 1;
        &#125;
        return;
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    build(x&lt;&lt;1, l, mid);
    build(x&lt;&lt;1|1, mid+1, r);
    push_up(x);
&#125;

ll qlsum(int x, int l, int r, int L, int R)&#123;
    if(L &lt;&#x3D; l &amp;&amp; r &lt;&#x3D; R)&#123;
        return lsum[x];
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    ll res &#x3D; 0;
    if(L &lt;&#x3D; mid)&#123;
        res +&#x3D; qlsum(x&lt;&lt;1, l, mid, L, R);
    &#125;
    if(R &gt; mid)&#123;
        res +&#x3D; qlsum(x&lt;&lt;1|1, mid+1, r, L, R);
    &#125;
    return res;
&#125;

ll qlsum2(int x, int l, int r, int L, int R)&#123;
    if(L &lt;&#x3D; l &amp;&amp; r &lt;&#x3D; R)&#123;
        return lsum2[x];
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    ll res &#x3D; 0;
    if(L &lt;&#x3D; mid)&#123;
        res +&#x3D; qlsum2(x&lt;&lt;1, l, mid, L, R);
    &#125;
    if(R &gt; mid)&#123;
        res +&#x3D; qlsum2(x&lt;&lt;1|1, mid+1, r, L, R);
    &#125;
    return res;
&#125;

void updl(int x, int l, int r, int p, ll v)&#123;
    if(l &#x3D;&#x3D; r)&#123;
        lsum[x] &#x3D; v;
        lsum2[x] &#x3D; v*(n-p)%mod;
        return;
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    if(p &lt;&#x3D; mid)&#123;
        updl(x&lt;&lt;1, l, mid, p, v);
    &#125;else&#123;
        updl(x&lt;&lt;1|1, mid+1, r, p, v);
    &#125;
    lsum[x] &#x3D; lsum[x&lt;&lt;1] + lsum[x&lt;&lt;1|1];
    lsum2[x] &#x3D; lsum2[x&lt;&lt;1] + lsum2[x&lt;&lt;1|1];
&#125;

ll qrsum(int x, int l, int r, int L, int R)&#123;
    if(L &lt;&#x3D; l &amp;&amp; r &lt;&#x3D; R)&#123;
        return rsum[x];
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    ll res &#x3D; 0;
    if(L &lt;&#x3D; mid)&#123;
        res +&#x3D; qrsum(x&lt;&lt;1, l, mid, L, R);
    &#125;
    if(R &gt; mid)&#123;
        res +&#x3D; qrsum(x&lt;&lt;1|1, mid+1, r, L, R);
    &#125;
    return res;
&#125;

ll qrsum2(int x, int l, int r, int L, int R)&#123;
    if(L &lt;&#x3D; l &amp;&amp; r &lt;&#x3D; R)&#123;
        return rsum2[x];
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    ll res &#x3D; 0;
    if(L &lt;&#x3D; mid)&#123;
        res +&#x3D; qrsum2(x&lt;&lt;1, l, mid, L, R);
    &#125;
    if(R &gt; mid)&#123;
        res +&#x3D; qrsum2(x&lt;&lt;1|1, mid+1, r, L, R);
    &#125;
    return res;
&#125;

void updr(int x, int l, int r, int p, ll v)&#123;
    if(l &#x3D;&#x3D; r)&#123;
        rsum[x] &#x3D; v;
        rsum2[x] &#x3D; v*p%mod;
        return;
    &#125;
    int mid &#x3D; (l+r)&#x2F;2;
    if(p &lt;&#x3D; mid)&#123;
        updr(x&lt;&lt;1, l, mid, p, v);
    &#125;else&#123;
        updr(x&lt;&lt;1|1, mid+1, r, p, v);
    &#125;
    rsum[x] &#x3D; rsum[x&lt;&lt;1] + rsum[x&lt;&lt;1|1];
    rsum2[x] &#x3D; rsum2[x&lt;&lt;1] + rsum2[x&lt;&lt;1|1];
&#125;

void add(int l, int r, ll v)&#123;
    b[l] +&#x3D; v;
    b[r+1] -&#x3D; v;
&#125;

int main()&#123;
    freopen(&quot;gcd.in&quot;, &quot;r&quot;, stdin);
    freopen(&quot;gcd.out&quot;, &quot;w&quot;, stdout);
    cin.tie(0);
    ios::sync_with_stdio(false);
    cin &gt;&gt; n;
    for(int i &#x3D; 1; i &lt;&#x3D; n; i++)cin &gt;&gt; a[i];
    for(int i &#x3D; 1; i &lt;&#x3D; n; i++)&#123;
        lx[i][0] &#x3D; a[i];
        rx[i][0] &#x3D; a[i];
    &#125;
    for(int j &#x3D; 1; j &lt; 18; j++)&#123;
        for(int i &#x3D; 1; i &lt;&#x3D; n; i++)&#123;
            if(i-(1&lt;&lt;j)+1 &gt;&#x3D; 1)&#123;
                lx[i][j] &#x3D; gcd(lx[i][j-1], lx[i-(1&lt;&lt;(j-1))][j-1]);
            &#125;
            if(i+(1&lt;&lt;j)-1 &lt;&#x3D; n)&#123;
                rx[i][j] &#x3D; gcd(rx[i][j-1], rx[i+(1&lt;&lt;(j-1))][j-1]);
            &#125;
        &#125;
    &#125;
    for(int i &#x3D; 1; i &lt;&#x3D; n; i++)&#123;
        int p &#x3D; i, g &#x3D; a[i];
        while(p &gt;&#x3D; 1)&#123;
            int _p &#x3D; p;
            for(int j &#x3D; 17; j &gt;&#x3D; 0; j--)&#123;
                if(p-(1&lt;&lt;j)+1 &gt;&#x3D; 1 &amp;&amp; gcd(g, lx[p][j]) &#x3D;&#x3D; g)&#123;
                    p &#x3D; p - (1&lt;&lt;j);
                &#125;
            &#125;
            lv[find(g)].push_back(Info(i, p+1, _p));
            g &#x3D; gcd(g, a[p]);
        &#125;
    &#125;
    for(int i &#x3D; 1; i &lt;&#x3D; n; i++)&#123;
        int p &#x3D; i, g &#x3D; a[i];
        while(p &lt;&#x3D; n)&#123;
            int _p &#x3D; p;
            for(int j &#x3D; 17; j &gt;&#x3D; 0; j--)&#123;
                if(p+(1&lt;&lt;j)-1 &lt;&#x3D; n &amp;&amp; gcd(g, rx[p][j]) &#x3D;&#x3D; g)&#123;
                    p &#x3D; p + (1&lt;&lt;j);
                &#125;
            &#125;
            rv[find(g)].push_back(Info(i, p-1, _p));
            g &#x3D; gcd(g, a[p]);
        &#125;
    &#125;
    build(1, 0, n+1);
    for(auto bp : mp)&#123;
        int g &#x3D; bp.first, id &#x3D; bp.second;
        sort(lv[id].begin(), lv[id].end(), [&amp;](Info a, Info b)&#123;
            return a.id &lt; b.id;
        &#125;);
        ll sum &#x3D; 1;
        vector&lt;int&gt; vec;
        for(auto info : lv[id])&#123;
            int x &#x3D; info.id, p &#x3D; info.p, _p &#x3D; info._p;
            vec.push_back(x);
            ll res &#x3D; qlsum(1, 0, n+1, 0, p-1)*(_p-p+1) + qlsum2(1, 0, n+1, p, _p) - qlsum(1, 0, n+1, p, _p)*(n-_p);
            res &#x3D; (res % mod + mod) % mod;
            sum +&#x3D; res;
            updl(1, 0, n+1, x, res);
        &#125;
        sum %&#x3D; mod;
        sort(rv[id].begin(), rv[id].end(), [&amp;](Info a, Info b)&#123;
            return a.id &gt; b.id;
        &#125;);
        for(auto info : rv[id])&#123;
            int x &#x3D; info.id, p &#x3D; info.p, _p &#x3D; info._p;
            vec.push_back(x);
            ll res &#x3D; qrsum(1, 0, n+1, p+1, n+1)*(p-_p+1) + qrsum2(1, 0, n+1, _p, p) - qrsum(1, 0, n+1, _p, p)*_p;
            res &#x3D; (res % mod + mod) % mod;
            updr(1, 0, n+1, x, res);
        &#125;
        sort(vec.begin(), vec.end());
        vec.erase(unique(vec.begin(), vec.end()), vec.end());
        int x &#x3D; 0;
        for(auto _x : vec)&#123;
            ll tmp &#x3D; (qlsum(1, 0, n+1, 0, _x-1)%mod)*(qrsum(1, 0, n+1, _x+1, n+1)%mod)%mod;
            ans[_x] +&#x3D; sum-tmp;
            if(_x - x &gt; 1)&#123;
                add(x+1, _x-1, (sum - (qlsum(1, 0, n+1, 0, x)%mod)*(qrsum(1, 0, n+1, _x, n+1)%mod))%mod);
            &#125;
            x &#x3D; _x;
        &#125;
        if(x &lt; n)&#123;
            add(x+1, n, sum - qlsum(1, 0, n+1, 0, x));
        &#125;
        for(auto info : lv[id])&#123;
            int x &#x3D; info.id;
            updl(1, 0, n+1, x, 0);
        &#125;
        for(auto info : rv[id])&#123;
            int x &#x3D; info.id;
            updr(1, 0, n+1, x, 0);
        &#125;
    &#125;
    for(int i &#x3D; 1; i &lt;&#x3D; n; i++)&#123;
        b[i] +&#x3D; b[i-1];
        ans[i] +&#x3D; b[i];
        ans[i] &#x3D; (ans[i] % mod + mod) % mod;
        printf(&quot;%d\n&quot;, ans[i]);
    &#125;
    return 0;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="我的代码"><a href="#我的代码" class="headerlink" title="我的代码"></a>我的代码</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;vector></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;map></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;set></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">For</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>l<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>r<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">Rof</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>l<span class="token punctuation">;</span>i<span class="token operator">>=</span>r<span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span></span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">P</span> <span class="token expression">pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">int</span> <span class="token expression"><span class="token keyword">long</span> <span class="token keyword">long</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">x</span> <span class="token expression">first</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">y</span> <span class="token expression">second</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">gcd</span> <span class="token expression">__gcd</span></span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">rd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> x<span class="token punctuation">;</span><span class="token keyword">return</span> cin<span class="token operator">>></span>x<span class="token punctuation">,</span>x<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x3f3f3f3f3f3f3f3f</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> mod <span class="token operator">=</span> <span class="token number">998244353</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">201234</span><span class="token punctuation">;</span>
bool ST<span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token punctuation">,</span>a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>ans<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//用 map 存储 gcd ，离散化 </span>
map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span> mp<span class="token punctuation">;</span>
<span class="token keyword">int</span> tot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> mp<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>tot<span class="token punctuation">;</span>
	<span class="token keyword">return</span> mp<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//预处理 RMQ </span>
<span class="token keyword">int</span> fl<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fr<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//fl是向左，fr是向右 </span>
<span class="token keyword">void</span> <span class="token function">pre_RMQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">For</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span> fl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> fr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">For</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>n<span class="token punctuation">;</span>i<span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span>
		fl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span>fl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fl<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">For</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		fr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span>fr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>fr<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//倍增求 gcd 及其区间 </span>
<span class="token keyword">struct</span> <span class="token class-name">I</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> id<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>I<span class="token operator">></span> gl<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>gr<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token comment">//gl[g]=&#123;i,l,r&#125; 固定右端点 i ，对于 j 属于 [l,r] 满足 GCD&#123;a[j~i]&#125; = g </span>
	<span class="token function">For</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> l <span class="token operator">=</span> i<span class="token punctuation">,</span> g <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
		<span class="token keyword">while</span><span class="token punctuation">(</span>l<span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> r <span class="token operator">=</span> l<span class="token punctuation">;</span>
			<span class="token function">Rof</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">>=</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>fl<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span>g<span class="token punctuation">)</span>
					l <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
			gl<span class="token punctuation">[</span><span class="token function">find</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">,</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//注意：当前的 l 已经超出限制 </span>
			g <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> a<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">//gr[g]=&#123;i,l,r&#125; 固定左端点 i ，对于 j 属于 [l,r] 满足 GCD&#123;a[i~j]&#125; = g </span>
	<span class="token function">For</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> r <span class="token operator">=</span> i<span class="token punctuation">,</span> g <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>r<span class="token operator">&lt;=</span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> l <span class="token operator">=</span> r<span class="token punctuation">;</span>
			<span class="token function">Rof</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;=</span>n <span class="token operator">&amp;&amp;</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>fr<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span>g<span class="token punctuation">)</span>
					r <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
			gr<span class="token punctuation">[</span><span class="token function">find</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//注意：当前的 r 已经超出限制 </span>
			g <span class="token operator">=</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g <span class="token punctuation">,</span>a<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">mid</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>l<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ls</span> <span class="token expression"><span class="token punctuation">(</span>p<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">rs</span> <span class="token expression"><span class="token punctuation">(</span>p<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token operator">|</span><span class="token number">1</span><span class="token punctuation">)</span></span></span>
<span class="token keyword">struct</span> <span class="token class-name">Segment_Tree</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Tr</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> sum<span class="token punctuation">,</span>sum2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>tr<span class="token punctuation">[</span>N<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token operator">|</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">pushup</span><span class="token punctuation">(</span>Tr <span class="token operator">&amp;</span>T<span class="token punctuation">,</span>Tr L<span class="token punctuation">,</span>Tr R<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>T <span class="token operator">=</span> <span class="token punctuation">&#123;</span>L<span class="token punctuation">.</span>sum<span class="token operator">+</span>R<span class="token punctuation">.</span>sum<span class="token punctuation">,</span> L<span class="token punctuation">.</span>sum2<span class="token operator">+</span>R<span class="token punctuation">.</span>sum2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
	<span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">==</span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>sum2 <span class="token operator">=</span> val<span class="token operator">*</span>pos<span class="token operator">%</span>mod<span class="token punctuation">;</span>
			tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>sum <span class="token operator">=</span> val<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>pos<span class="token operator">&lt;=</span>mid<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>pos<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">update</span><span class="token punctuation">(</span>rs<span class="token punctuation">,</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>pos<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">pushup</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span>tr<span class="token punctuation">[</span>ls<span class="token punctuation">]</span><span class="token punctuation">,</span>tr<span class="token punctuation">[</span>rs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">inline</span> Tr <span class="token function">ask</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> L<span class="token punctuation">,</span><span class="token keyword">int</span> R<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>L<span class="token operator">&lt;=</span>l <span class="token operator">&amp;&amp;</span> r<span class="token operator">&lt;=</span>R<span class="token punctuation">)</span> <span class="token keyword">return</span> tr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>R<span class="token operator">&lt;=</span>mid<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">ask</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>L<span class="token punctuation">,</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>L<span class="token operator">></span>mid<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">ask</span><span class="token punctuation">(</span>rs<span class="token punctuation">,</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>L<span class="token punctuation">,</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Tr T<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token function">pushup</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span><span class="token function">ask</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span>l<span class="token punctuation">,</span>mid<span class="token punctuation">,</span>L<span class="token punctuation">,</span>mid<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ask</span><span class="token punctuation">(</span>rs<span class="token punctuation">,</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>R<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>T<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>T1<span class="token punctuation">,</span>T2<span class="token punctuation">;</span>


<span class="token keyword">int</span> c<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//维护前缀和 </span>
<span class="token keyword">void</span> <span class="token function">Solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token comment">//建树，更新初始值(注意！！！这不是一种方案！！！) </span>
	T1<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	T2<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//枚举 gcd O(nlogn)</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> pg<span class="token operator">:</span>mp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> id <span class="token operator">=</span> pg<span class="token punctuation">.</span>y<span class="token punctuation">;</span><span class="token comment">//当前 gcd 对应的 id</span>
		
		<span class="token function">sort</span><span class="token punctuation">(</span>gl<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>gl<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>I a<span class="token punctuation">,</span>I b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>id<span class="token operator">&lt;</span>b<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//起始点从小到大</span>
		<span class="token function">sort</span><span class="token punctuation">(</span>gr<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>gr<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>I a<span class="token punctuation">,</span>I b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> a<span class="token punctuation">.</span>id<span class="token operator">></span>b<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//起始点从大到小</span>
		
		vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">;</span><span class="token comment">//记录出现的区间的id</span>
		
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p<span class="token operator">:</span>gl<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//p:区间interval </span>
			<span class="token keyword">int</span> i<span class="token operator">=</span>p<span class="token punctuation">.</span>id<span class="token punctuation">,</span>l<span class="token operator">=</span>p<span class="token punctuation">.</span>x<span class="token punctuation">,</span>r<span class="token operator">=</span>p<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
			vec<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> res <span class="token operator">=</span> T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token operator">+</span> T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>sum <span class="token operator">*</span> r
					<span class="token operator">-</span> T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>sum2<span class="token punctuation">;</span>
			res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">%</span>mod<span class="token operator">+</span>mod<span class="token punctuation">)</span><span class="token operator">%</span>mod<span class="token punctuation">;</span>
			T1<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p<span class="token operator">:</span>gr<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//p:区间interval </span>
			<span class="token keyword">int</span> i<span class="token operator">=</span>p<span class="token punctuation">.</span>id<span class="token punctuation">,</span>l<span class="token operator">=</span>p<span class="token punctuation">.</span>x<span class="token punctuation">,</span>r<span class="token operator">=</span>p<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
			vec<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> res <span class="token operator">=</span> T2<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
					<span class="token operator">-</span> T2<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>sum <span class="token operator">*</span> l
					<span class="token operator">+</span> T2<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>sum2<span class="token punctuation">;</span>
			res <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token operator">%</span>mod<span class="token operator">+</span>mod<span class="token punctuation">)</span><span class="token operator">%</span>mod<span class="token punctuation">;</span>
			T2<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
			
		<span class="token comment">//将出现的区间id排序加去重 </span>
		<span class="token function">sort</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		vec<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">auto</span> add <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>c<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">+=</span> v<span class="token punctuation">,</span> c<span class="token punctuation">[</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-=</span> v<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//前缀和</span>
		<span class="token keyword">int</span> sum <span class="token operator">=</span> T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">;</span>
		
		<span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> r<span class="token operator">:</span>vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//对 x 贡献为 f(0,x-1)*g(x+1,n+1) </span>
			<span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token operator">%</span>mod<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>T2<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token operator">%</span>mod<span class="token punctuation">)</span> <span class="token operator">%</span> mod<span class="token punctuation">;</span>
			ans<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">+=</span> sum <span class="token operator">-</span> tmp<span class="token punctuation">;</span><span class="token comment">//总数减去没有用到当前 x 的个数 </span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//如果 l 和 r 之间有数字 </span>
				<span class="token comment">//维护前缀和加减 (对[l+1,r-1]区间所有的点的贡献都是...(见下)) </span>
				<span class="token function">add</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sum <span class="token operator">-</span> <span class="token punctuation">(</span>T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token operator">%</span>mod<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>T2<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token operator">%</span>mod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>mod<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>l <span class="token operator">=</span> r<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">&lt;</span>n<span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> sum <span class="token operator">-</span> <span class="token punctuation">(</span>T1<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token operator">%</span>mod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//清空线段树 </span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p<span class="token operator">:</span>gl<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> T1<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>p<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> p<span class="token operator">:</span>gr<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> T2<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>p<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

bool ED<span class="token punctuation">;</span>
<span class="token comment">//看到题目就开走，不跑样例是小狗 </span>
<span class="token comment">//不打暴力是小狗 </span>
<span class="token keyword">signed</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	ios<span class="token operator">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">,</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cerr<span class="token operator">&lt;&lt;</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ST<span class="token operator">-</span><span class="token operator">&amp;</span>ED<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024.</span><span class="token operator">/</span><span class="token number">1024.</span><span class="token operator">&lt;&lt;</span><span class="token string">"MB\n"</span><span class="token punctuation">;</span>
	<span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"gcd.in"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"gcd.out"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cin<span class="token operator">>></span>n<span class="token punctuation">;</span><span class="token keyword">int</span> Tim <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">For</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">pre_RMQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">For</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> c<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">%</span>mod<span class="token operator">+</span>mod<span class="token punctuation">)</span><span class="token operator">%</span>mod<span class="token punctuation">;</span>
		cout<span class="token operator">&lt;&lt;</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token char">'\n'</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">return</span> cerr<span class="token operator">&lt;&lt;</span><span class="token string">"TIME:"</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>Tim<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000.</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="https://wolfdeer62456.github.io/about" rel="external nofollow noreferrer">WolfDeer</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a target="_blank" rel="noopener" href="https://wolfdeer62456.github.iohttps://wolfdeer62456.github.io/2024/08/08/C240808C-%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA%E9%A2%98/">https://wolfdeer62456.github.iohttps://wolfdeer62456.github.io/2024/08/08/C240808C-%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA%E9%A2%98/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="https://wolfdeer62456.github.io/about" target="_blank">WolfDeer</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="https://wolfdeer62456.github.io/tags/gcd/"><span class="chip bg-color">gcd</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="https://wolfdeer62456.github.io/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://wolfdeer62456.github.io/libs/share/js/social-share.min.js"></script></div></div></div><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="https://wolfdeer62456.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="https://wolfdeer62456.github.io/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="https://wolfdeer62456.github.io/2024/08/08/C240808D-%E6%89%93%E5%AD%97%E6%9C%BA/"><div class="card-image"><img src="https://wolfdeer62456.github.io/medias/featureimages/10.jpg" class="responsive-img" alt="#C240808D. 打字机"> <span class="card-title">#C240808D. 打字机</span></div></a><div class="card-content article-content"><div class="summary block-with-text">思维</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-08-08 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="https://wolfdeer62456.github.io/categories/%E9%A2%98%E7%9B%AE/" class="post-category">题目</a></span></div></div><div class="card-action article-tags"><a href="https://wolfdeer62456.github.io/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="chip bg-color">动态规划</span> </a><a href="https://wolfdeer62456.github.io/tags/Trie%E6%A0%91/"><span class="chip bg-color">Trie树</span> </a><a href="https://wolfdeer62456.github.io/tags/%E6%A6%82%E7%8E%87dp/"><span class="chip bg-color">概率dp</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="https://wolfdeer62456.github.io/2024/08/08/%E6%88%91%E4%B8%BA%E6%88%91%E8%87%AA%E5%B7%B1%E8%80%8C%E6%88%98/"><div class="card-image"><img src="https://wolfdeer62456.github.io/medias/featureimages/22.jpg" class="responsive-img" alt="我为我自己而战"> <span class="card-title">我为我自己而战</span></div></a><div class="card-content article-content"><div class="summary block-with-text">加油</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-08-08 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="https://wolfdeer62456.github.io/categories/%E8%AF%B4%E8%AF%B4/" class="post-category">说说</a></span></div></div></div></div></div></article></div><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/prism/prism.min.js"></script><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://wolfdeer62456.github.io/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h1, h2, h3, h4"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget"),n=($(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")}),"expanded"),i=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){i.hasClass(n)?(i.removeClass(n).hide(),l.removeClass("l9")):(i.addClass(n).show(),l.addClass("l9"));var e="artDetail",o="prenext-posts";if(0!==(e=$("#"+e)).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+o).width(t)}})})</script></main><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS_HTML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}})</script><footer class="page-footer bg-color"><link rel="stylesheet" href="https://wolfdeer62456.github.io/libs/aplayer/APlayer.min.css"><style>.aplayer .aplayer-lrc p{display:none;font-size:12px;font-weight:700;line-height:16px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{display:none;font-size:15px;color:#42b983}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><div><div class="row"><meting-js class="col l8 offset-l2 m10 offset-m1 s12" server="netease" type="playlist" id="503838841" fixed="true" autoplay theme="#42b983" loop order="random" preload="auto" volume="0.7" list-folded="true"></meting-js></div></div><script src="https://wolfdeer62456.github.io/libs/aplayer/APlayer.min.js"></script><script src="https://wolfdeer62456.github.io/libs/aplayer/Meting.min.js"></script><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2023-2025</span> <a href="https://wolfdeer62456.github.io/about" target="_blank">WolfDeer</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">286.5k</span> <span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t="2023",n=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),e=e.getSeconds(),s=Date.UTC(t,"11","1","6","24","56"),i=Date.UTC(n,i,a,r,o,e)-s,a=Math.floor(i/31536e6),r=Math.floor(i/864e5-365*a);t===String(n)?(document.getElementById("year").innerHTML=n,o="This site has been running for "+r+" days",o="本站已运行 "+r+" 天",document.getElementById("sitetime").innerHTML=o):(document.getElementById("year").innerHTML=t+" - "+n,e="This site has been running for "+a+" years and "+r+" days",e="本站已运行 "+a+" 年 "+r+" 天",document.getElementById("sitetime").innerHTML=e)};calcSiteTime()</script><br></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/WolfDeer62456" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:2054247998@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2054247998" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2054247998" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://wolfdeer62456.github.io/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script type="text/javascript">$(function(){var t,n,s;t="https://wolfdeer62456.github.io/search.xml",n="searchInput",s="searchResult",$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),t=document.getElementById(n),r=document.getElementById(s);t.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);r.innerHTML="",this.value.trim().length<=0||(e.forEach(function(t){var r,e,n,s=!0,l=t.title.trim().toLowerCase(),a=t.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=0===(i=t.url).indexOf("/")?t.url:"/"+i,c=-1,u=-1;""!==l&&""!==a&&h.forEach(function(t,e){r=l.indexOf(t),c=a.indexOf(t),r<0&&c<0?s=!1:(c<0&&(c=0),0===e&&(u=c))}),s&&(o+="<li><a href='"+i+"' class='search-result-title'>"+l+"</a>",i=t.content.trim().replace(/<[^>]+>/g,""),0<=u&&(t=u+80,(t=0===(e=(e=u-20)<0?0:e)?100:t)>i.length&&(t=i.length),n=i.substr(e,t),h.forEach(function(t){var e=new RegExp(t,"gi");n=n.replace(e,'<em class="search-keyword">'+t+"</em>")}),o+='<p class="search-result">'+n+"...</p>"),o+="</li>")}),o+="</ul>",r.innerHTML=o)})}})})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://wolfdeer62456.github.io/libs/materialize/materialize.min.js"></script><script src="https://wolfdeer62456.github.io/libs/masonry/masonry.pkgd.min.js"></script><script src="https://wolfdeer62456.github.io/libs/aos/aos.js"></script><script src="https://wolfdeer62456.github.io/libs/scrollprogress/scrollProgress.min.js"></script><script src="https://wolfdeer62456.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://wolfdeer62456.github.io/js/matery.js"></script><script type="text/javascript">var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="https://wolfdeer62456.github.io/libs/others/star.js"><\/script>')</script><script src="https://wolfdeer62456.github.io/libs/others/clicklove.js" async></script><script type="text/javascript" color="0,0,255" pointcolor="0,0,255" opacity="0.7" zindex="-1" count="99" src="https://wolfdeer62456.github.io/libs/background/canvas-nest.js"></script><script type="text/javascript" src="https://wolfdeer62456.github.io/libs/background/ribbon-dynamic.js" async></script><script src="https://wolfdeer62456.github.io/libs/instantpage/instantpage.js" type="module"></script></body></html>